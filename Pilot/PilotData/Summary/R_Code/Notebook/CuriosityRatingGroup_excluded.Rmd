---
output:
  html_document:
    fig_caption: yes
    highlight: default
    number_sections: yes
    theme: lumen
    toc: yes
    toc_depth: 5
    toc_float: 
      collapsed: true
      smooth_scroll: true
  header-includes:
  - \usepackage{xcolor}
  - \usepackage{framed}
  - \usepackage{fontspec}
  html_notebook:
    
    fig_caption: yes
    highlight: default
    number_sections: yes
    theme: lumen
    toc: yes
    toc_depth: 5
    toc_float: true
  pdf_document:
    fig_caption: yes
    highlight: default
    latex_engine: xelatex
    number_sections: yes
    toc: yes
    toc_depth: 5
---

\setmainfont{Calibri}
\colorlet{shadecolor}{gray!10}
\color{red}

<style>
body {
  font-size: 15px;
}

p.caption {
  font-weight: 500;
  font-style: italic;
}

code.r {
  font-family: Consolas, Monaco, monospace;
  font-size: 12px;
}
</style>

```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(kableExtra)
options(knitr.table.format = "html", cache=TRUE) # "latex" for PDF
```

```{r, echo = FALSE, message=FALSE, warning=FALSE}
library(data.table); library(ggplot2); library(nlme); library(Hmisc); library(multcomp)
```

```{r, echo = FALSE, message=FALSE, warning=FALSE}
# load("~/Documents/OneDrive - Cardiff University/Projects/VRCuriosityMemory/PilotData/RawData/Pilot_02/.RData")
load("D:/OneDirve_CU/OneDrive - Cardiff University/Projects/VRCuriosityMemory/PilotData/RawData/Summary/Summary.RData")
# load("D:/Danlu.C - CU OneDrive/OneDrive - Cardiff University/Projects/VRCuriosityMemory/PilotData/RawData/Summary/Summary.RData")
```

# Outside: Item
## Examine the difference between *High* and *Low* curiosity groups
```{r, echo = FALSE}
baseline          <- lme(CorrSeenHit ~ 1, random = ~ 1|SubjectNo/RatingGroup, data = Curiosity.Recall.Old.Collapsed.CuriosityType.MeanSep[!SubjectNo %in% bad.ps.less.strict], method = "ML", na.action = na.exclude)

versionModel      <- update(baseline,     .~. + Version)
ratingModel       <- update(versionModel, .~. + RatingGroup)
interactionModel  <- update(ratingModel,  .~. + Version : RatingGroup)

anova(baseline, versionModel, ratingModel, interactionModel)
```

### Parameters
```{r, echo=FALSE}
summary(ratingModel)$tTable
```

## Compare "Early" and "Late"
```{r, echo=FALSE}
baseline          <- lme(CorrSeenHit ~ 1, random = ~ 1|SubjectNo/RatingGroup/ItemOrderType, data = Curiosity.Recall.Old.Order.CuriosityType.MeanSep[!SubjectNo %in% bad.ps.less.strict], method = "ML", na.action = na.exclude)

orderModel        <- update(baseline,       .~. + ItemOrderType)
ratingModel       <- update(orderModel,     .~. + RatingGroup)
versionModel      <- update(ratingModel,    .~. + Version)

ord.rt.Model      <- update(versionModel,   .~. + ItemOrderType : RatingGroup)
ord.vs.Model      <- update(ord.rt.Model,   .~. + ItemOrderType : Version)
rt.vs.Model       <- update(ord.vs.Model,   .~. + RatingGroup : Version)

interactionModel  <- update(rt.vs.Model,    .~. + Version : RatingGroup : ItemOrderType)

anova(baseline, orderModel, ratingModel, versionModel, ord.rt.Model, ord.vs.Model, rt.vs.Model, interactionModel)
```

### Parameters
```{r, echo=FALSE}
summary(versionModel)$tTable
```

# Outside: Source
## Examine the difference between *High* and *Low* curiosity groups
```{r, echo = FALSE}
baseline          <- lme(CorrContextAccuracy ~ 1, random = ~ 1|SubjectNo/RatingGroup, data = Curiosity.Recall.Old.Collapsed.CuriosityType.MeanSep[!SubjectNo %in% bad.ps.less.strict], method = "ML", na.action = na.exclude)

versionModel      <- update(baseline,     .~. + Version)
ratingModel       <- update(versionModel, .~. + RatingGroup)
interactionModel  <- update(ratingModel,  .~. + Version : RatingGroup)

anova(baseline, versionModel, ratingModel, interactionModel)
```

### Parameters
```{r, echo = FALSE}
summary(interactionModel)$tTable

contrast.matrix <- rbind(
  "Immediate: High - Low"     = c(0, 0, 1, 0),
  "Delayed:   High - Low"     = c(0, 0, 1, 1)
  )
postHocs <- glht(interactionModel, contrast.matrix)
summary(postHocs, test = adjusted("none"))
```

## Compare "Early" and "Late"
```{r, echo=FALSE}
baseline          <- lme(CorrContextAccuracy ~ 1, random = ~ 1|SubjectNo/RatingGroup/ItemOrderType, data = Curiosity.Recall.Old.Order.CuriosityType.MeanSep[!SubjectNo %in% bad.ps.less.strict], method = "ML", na.action = na.exclude)

orderModel        <- update(baseline,       .~. + ItemOrderType)
ratingModel       <- update(orderModel,     .~. + RatingGroup)
versionModel      <- update(ratingModel,    .~. + Version)

ord.rt.Model      <- update(versionModel,   .~. + ItemOrderType : RatingGroup)
ord.vs.Model      <- update(ord.rt.Model,   .~. + ItemOrderType : Version)
rt.vs.Model       <- update(ord.vs.Model,   .~. + RatingGroup : Version)

interactionModel  <- update(rt.vs.Model,    .~. + Version : RatingGroup : ItemOrderType)

anova(baseline, orderModel, ratingModel, versionModel, ord.rt.Model, ord.vs.Model, rt.vs.Model, interactionModel)
```

### Parameters
```{r, echo=FALSE}
summary(ord.rt.Model)$tTable

contrast.matrix   <- rbind(
  "Early: High - Low"         = c(0, 0, 1, 0, 0),
  "Late:  High - Low"         = c(0, 0, 1, 0, 1)
)

postHocs <- glht(ord.rt.Model, contrast.matrix)
summary(postHocs, test = adjusted("none"))
```

# Inside: Item
## Examine the difference between *High* and *Low* curiosity groups
```{r, echo = FALSE}
baseline          <- lme(CorrSeenHit ~ 1, random = ~ 1|SubjectNo/RatingGroup, data = Encoding.Recall.Old.Collapsed.CuriosityType.MeanSep[!SubjectNo %in% bad.ps.less.strict], method = "ML", na.action = na.exclude)

versionModel      <- update(baseline,     .~. + Version)
ratingModel       <- update(versionModel, .~. + RatingGroup)
interactionModel  <- update(ratingModel,  .~. + Version : RatingGroup)

anova(baseline, versionModel, ratingModel, interactionModel)
```

### Parameters
```{r, echo = FALSE}
summary(interactionModel)$tTable

contrast.matrix <- rbind(
  "Immediate: High - Low"     = c(0, 0, 1, 0),
  "Delayed:   High - Low"     = c(0, 0, 1, 1)
  )
postHocs <- glht(interactionModel, contrast.matrix)
summary(postHocs, test = adjusted("none"))
```

## Compare "Early" and "Late"
```{r, echo=FALSE}
baseline          <- lme(CorrSeenHit ~ 1, random = ~ 1|SubjectNo/RatingGroup/ItemOrderType, data = Encoding.Recall.Old.Order.CuriosityType.MeanSep[!SubjectNo %in% bad.ps.less.strict], method = "ML", na.action = na.exclude)

orderModel        <- update(baseline,       .~. + ItemOrderType)
ratingModel       <- update(orderModel,     .~. + RatingGroup)
versionModel      <- update(ratingModel,    .~. + Version)

ord.rt.Model      <- update(versionModel,   .~. + ItemOrderType : RatingGroup)
ord.vs.Model      <- update(ord.rt.Model,   .~. + ItemOrderType : Version)
rt.vs.Model       <- update(ord.vs.Model,   .~. + RatingGroup : Version)

interactionModel  <- update(rt.vs.Model,    .~. + Version : RatingGroup : ItemOrderType)

anova(baseline, orderModel, ratingModel, versionModel, ord.rt.Model, ord.vs.Model, rt.vs.Model, interactionModel)
```

### Parameters
```{r, echo=FALSE}
summary(rt.vs.Model)$tTable

contrast.matrix <- rbind(
  "Immediate: High - Low"     = c(0, 0, 1, 0, 0, 0, 0),
  "Delayed:   High - Low"     = c(0, 0, 1, 0, 0, 0, 1)
  )
postHocs <- glht(rt.vs.Model, contrast.matrix)
summary(postHocs, test = adjusted("none"))
```

# Inside: Source
## Examine the difference between *High* and *Low* curiosity groups
```{r, echo = FALSE}
baseline          <- lme(CorrContextAccuracy ~ 1, random = ~ 1|SubjectNo/RatingGroup, data = Encoding.Recall.Old.Collapsed.CuriosityType.MeanSep[!SubjectNo %in% bad.ps.less.strict], method = "ML", na.action = na.exclude)

versionModel      <- update(baseline,     .~. + Version)
ratingModel       <- update(versionModel, .~. + RatingGroup)
interactionModel  <- update(ratingModel,  .~. + Version : RatingGroup)

anova(baseline, versionModel, ratingModel, interactionModel)
```

### Parameters
```{r, echo=FALSE}
summary(versionModel)$tTable
```

## Compare "Early" and "Late"
```{r, echo=FALSE}
baseline          <- lme(CorrContextAccuracy ~ 1, random = ~ 1|SubjectNo/RatingGroup/ItemOrderType, data = Encoding.Recall.Old.Order.CuriosityType.MeanSep[!SubjectNo %in% bad.ps.less.strict], method = "ML", na.action = na.exclude)

orderModel        <- update(baseline,       .~. + ItemOrderType)
ratingModel       <- update(orderModel,     .~. + RatingGroup)
versionModel      <- update(ratingModel,    .~. + Version)

ord.rt.Model      <- update(versionModel,   .~. + ItemOrderType : RatingGroup)
ord.vs.Model      <- update(ord.rt.Model,   .~. + ItemOrderType : Version)
rt.vs.Model       <- update(ord.vs.Model,   .~. + RatingGroup : Version)

interactionModel  <- update(rt.vs.Model,    .~. + Version : RatingGroup : ItemOrderType)

anova(baseline, orderModel, ratingModel, versionModel, ord.rt.Model, ord.vs.Model, rt.vs.Model, interactionModel)
```

### Parameters
```{r, echo=FALSE}
summary(versionModel)$tTable
```