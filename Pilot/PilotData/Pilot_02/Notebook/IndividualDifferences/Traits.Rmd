---
title: "Individual Differences"
output:
  html_document:
    fig_caption: yes
    highlight: default
    number_sections: yes
    theme: lumen
    toc: yes
    toc_depth: 5
    toc_float: 
      collapsed: true
      smooth_scroll: true
  header-includes:
  - \usepackage{xcolor}
  - \usepackage{framed}
  - \usepackage{fontspec}
  html_notebook:
    fig_caption: yes
    highlight: default
    number_sections: no
    theme: lumen
    toc: yes
    toc_depth: 5
    toc_float: true
  pdf_document:
    fig_caption: yes
    highlight: default
    latex_engine: xelatex
    number_sections: yes
    toc: yes
    toc_depth: 5
---

\setmainfont{Calibri}
\colorlet{shadecolor}{gray!10}
\color{red}

<style>
body {
  font-size: 15px;
}

p.caption {
  font-weight: 500;
  font-style: italic;
}

code.r {
  font-family: Consolas, Monaco, monospace;
  font-size: 12px;
}
</style>

```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(kableExtra)
options(knitr.table.format = "html", cache=TRUE) # "latex" for PDF
```

```{r import packages, echo = FALSE, message=FALSE, warning=FALSE}
library(data.table); library(ggplot2); library(nlme); library(cowplot)
```

```{r set dir, echo = FALSE, message=FALSE, warning=FALSE}
# load("~/Documents/OneDrive - Cardiff University/Projects/VRCuriosityMemory/PilotData/RawData/Pilot_02/.RData")
load("D:/OneDirve_CU/OneDrive - Cardiff University/Projects/VRCuriosityMemory/PilotData/RawData/Pilot_02/.RData")
# load("D:/Danlu.C - CU OneDrive/OneDrive - Cardiff University/Projects/VRCuriosityMemory/PilotData/RawData/Pilot_02/.RData")
# load("/home/danlu/Desktop/OneDrive - Cardiff University/Projects/VRCuriosityMemory/PilotData/RawData/Pilot_02/.RData")
```

``` {r get data ready, echo = FALSE, message = FALSE, warning = FALSE}
# Inside
InsideObjectsMemory_GP <- InsideObjectsMemory[!SubjectNo %in% bad.ps.less.strict]
InsideObjectsMemory_GP$PC <- 0
InsideObjectsMemory_GP$EC <- 0
InsideObjectsMemory_GP$GN <- 0

Encoding.Recall.Old.GP <- Encoding.Recall.Old[! SubjectNo %in% bad.ps.less.strict]
Encoding.Recall.Old.GP$PC <- 0
Encoding.Recall.Old.GP$EC <- 0
Encoding.Recall.Old.GP$GN <- 0

# Outside
OutsideObjectsMemory_GP <- OutsideObjectsMemory[! SubjectNo %in% bad.ps.less.strict]
OutsideObjectsMemory_GP$PC <- 0
OutsideObjectsMemory_GP$EC <- 0
OutsideObjectsMemory_GP$GN <- 0

Curiosity.Recall.Old.GP <- Curiosity.Recall.Old[! SubjectNo %in% bad.ps.less.strict]
Curiosity.Recall.Old.GP$PC <- 0
Curiosity.Recall.Old.GP$EC <- 0
Curiosity.Recall.Old.GP$GN <- 0

# Together
for (this.p in participant.folders) {
  InsideObjectsMemory_GP[SubjectNo == this.p]$PC <- questionnaire[SubjectNo == this.p]$PC
  InsideObjectsMemory_GP[SubjectNo == this.p]$EC <- questionnaire[SubjectNo == this.p]$EC
  InsideObjectsMemory_GP[SubjectNo == this.p]$GN <- questionnaire[SubjectNo == this.p]$GN
  
  OutsideObjectsMemory_GP[SubjectNo == this.p]$PC <- questionnaire[SubjectNo == this.p]$PC
  OutsideObjectsMemory_GP[SubjectNo == this.p]$EC <- questionnaire[SubjectNo == this.p]$EC
  OutsideObjectsMemory_GP[SubjectNo == this.p]$GN <- questionnaire[SubjectNo == this.p]$GN
  
  Encoding.Recall.Old.GP[SubjectNo == this.p]$PC <- questionnaire[SubjectNo == this.p]$PC
  Encoding.Recall.Old.GP[SubjectNo == this.p]$EC <- questionnaire[SubjectNo == this.p]$EC
  Encoding.Recall.Old.GP[SubjectNo == this.p]$GN <- questionnaire[SubjectNo == this.p]$GN
  
  Curiosity.Recall.Old.GP[SubjectNo == this.p]$PC <- questionnaire[SubjectNo == this.p]$PC
  Curiosity.Recall.Old.GP[SubjectNo == this.p]$EC <- questionnaire[SubjectNo == this.p]$EC
  Curiosity.Recall.Old.GP[SubjectNo == this.p]$GN <- questionnaire[SubjectNo == this.p]$GN
  
}
```

# Overview of the notebook
This notebook looks at how personal traits (PC and EC) affect any benefits of novelty or curiosity on memory.

There are several ways of doing this:

1. First of all, the trait scores can be the PC score or EC score or the mean of the two (`as a general score for curiosity as a trait?`).

2. Traits' influence on **novelty** effects.
    - This can be done by examining the interaction between the PC/EC/mean scores and *Novelty* in a repeated ANOVA.
    - This can also be done by calculating the correlation between the PC and EC scores and the difference in memory performance between the *familiar* and *novel* groups 

4. Traits' influence on **curiosity** effects.
    - Calculate the correlation between the PC and EC scores and the relationship (slope) between the curiosity and memory performance.
        - This could be done by including PC/EC/mean into the model and checking the parameters for the interaction.

# Novelty effects
## Correlation between trait scores and difference between *familiar* and *novel* groups.
### Inside the rooms
#### Recollection
```{r Calculate mean respectively for novel and familiar groups, echo = FALSE, echo = FALSE, message=FALSE, warnings = FALSE}
# Inside
InsideObjectsMemoryMean_GP <- InsideObjectsMemory_GP[, .(meanSeenHit = mean(SeenHit, na.rm = TRUE), meanContextAccuracy = mean(ContextAccuracy, na.rm = TRUE)), by = c("SubjectNo", "Group", "PC", "EC", "GN")]

# Outside
OutsideObjectsMemoryMean_GP <- OutsideObjectsMemory_GP[, .(meanSeenHit = mean(SeenHit, na.rm = TRUE), meanContextAccuracy = mean(ContextAccuracy, na.rm = TRUE)), by = c("SubjectNo", "Group", "PC", "EC", "GN")]

# Together
MemoryDifference <- NULL

participants <- as.character(unique(InsideObjectsMemoryMean_GP$SubjectNo))

for (this.p in participants) {
  this.data <- data.table(SubjectNo = this.p, PC = questionnaire[SubjectNo == this.p]$PC, EC = questionnaire[SubjectNo == this.p]$EC, GN = questionnaire[SubjectNo == this.p]$GN)
  this.data$diffSeenHitInside <- InsideObjectsMemoryMean_GP[SubjectNo == this.p & Group == "Novel"]$meanSeenHit - InsideObjectsMemoryMean_GP[SubjectNo == this.p & Group == "Familiar"]$meanSeenHit
  this.data$diffContextAccuracyInside <- InsideObjectsMemoryMean_GP[SubjectNo == this.p & Group == "Novel"]$meanContextAccuracy - InsideObjectsMemoryMean_GP[SubjectNo == this.p & Group == "Familiar"]$meanContextAccuracy
  this.data$diffSeenHitOutside <- OutsideObjectsMemoryMean_GP[SubjectNo == this.p & Group == "Novel"]$meanSeenHit - OutsideObjectsMemoryMean_GP[SubjectNo == this.p & Group == "Familiar"]$meanSeenHit
  this.data$diffContextAccuracyOutside <- OutsideObjectsMemoryMean_GP[SubjectNo == this.p & Group == "Novel"]$meanContextAccuracy - OutsideObjectsMemoryMean_GP[SubjectNo == this.p & Group == "Familiar"]$meanContextAccuracy
  
  MemoryDifference <- rbind(MemoryDifference, this.data)
}
```

```{r, echo = FALSE, fig.align='center', fig.width=10.8, fig.height=5.7}
PC_plot <- ggplot(data = MemoryDifference, aes(x = PC, y = diffSeenHitInside)) +
  geom_point(size = 2, color = "grey70") +
  stat_smooth(method = "lm", se = FALSE, color = "red") +
  labs(x = "PC score", y = "Difference in Hit Rate between Familiar and Novel rooms")

EC_plot <- ggplot(data = MemoryDifference, aes(x = EC, y = diffSeenHitInside)) +
  geom_point(size = 2, color = "grey70") +
  stat_smooth(method = "lm", se = FALSE, color = "red") +
  labs(x = "EC score", y = "") +
  theme(axis.title.y = element_blank())

GN_plot <- ggplot(data = MemoryDifference, aes(x = GN, y = diffSeenHitInside))  +
  geom_point(size = 2, color = "grey70") +
  stat_smooth(method = "lm", se = FALSE, color = "red") +
  labs(x = "Curiosity trait score", y = "") +
  theme(axis.title.y = element_blank())

plot_grid(PC_plot, EC_plot, GN_plot, nrow = 1, rel_widths = c(1.05, 0.925, 0.925))
```

```{r}
cor.test(MemoryDifference$diffSeenHitInside, MemoryDifference$PC, method = "pearson")
cor.test(MemoryDifference$diffSeenHitInside, MemoryDifference$EC, method = "pearson")
cor.test(MemoryDifference$diffSeenHitInside, MemoryDifference$GN, method = "pearson")
```

#### Source memory
```{r, echo = FALSE, fig.align='center', fig.width=10.8, fig.height=5.7}
PC_plot <- ggplot(data = MemoryDifference, aes(x = PC, y = diffContextAccuracyInside)) +
  geom_point(size = 2, color = "grey70") +
  stat_smooth(method = "lm", se = FALSE, color = "red") +
  labs(x = "PC score", y = "Difference in Source Memory between Familiar and Novel rooms")

EC_plot <- ggplot(data = MemoryDifference, aes(x = EC, y = diffContextAccuracyInside)) +
  geom_point(size = 2, color = "grey70") +
  stat_smooth(method = "lm", se = FALSE, color = "red") +
  labs(x = "EC score", y = "") +
  theme(axis.title.y = element_blank())

GN_plot <- ggplot(data = MemoryDifference, aes(x = GN, y = diffContextAccuracyInside))  +
  geom_point(size = 2, color = "grey70") +
  stat_smooth(method = "lm", se = FALSE, color = "red") +
  labs(x = "Curiosity trait score", y = "") +
  theme(axis.title.y = element_blank())

plot_grid(PC_plot, EC_plot, GN_plot, nrow = 1, rel_widths = c(1.05, 0.925, 0.925))
```

```{r}
cor.test(MemoryDifference$diffContextAccuracyInside, MemoryDifference$PC, method = "pearson")
cor.test(MemoryDifference$diffContextAccuracyInside, MemoryDifference$EC, method = "pearson")
cor.test(MemoryDifference$diffContextAccuracyInside, MemoryDifference$GN, method = "pearson")
```

### Outside the rooms
#### Recollection
```{r, echo = FALSE, fig.align='center', fig.width=10.8, fig.height=5.7}
PC_plot <- ggplot(data = MemoryDifference, aes(x = PC, y = diffSeenHitOutside)) +
  geom_point(size = 2, color = "grey70") +
  stat_smooth(method = "lm", se = FALSE, color = "red") +
  labs(x = "PC score", y = "Difference in Hit Rate between Familiar and Novel rooms")

EC_plot <- ggplot(data = MemoryDifference, aes(x = EC, y = diffSeenHitOutside)) +
  geom_point(size = 2, color = "grey70") +
  stat_smooth(method = "lm", se = FALSE, color = "red") +
  labs(x = "EC score", y = "") +
  theme(axis.title.y = element_blank())

GN_plot <- ggplot(data = MemoryDifference, aes(x = GN, y = diffSeenHitOutside))  +
  geom_point(size = 2, color = "grey70") +
  stat_smooth(method = "lm", se = FALSE, color = "red") +
  labs(x = "Curiosity trait score", y = "") +
  theme(axis.title.y = element_blank())

plot_grid(PC_plot, EC_plot, GN_plot, nrow = 1, rel_widths = c(1.05, 0.925, 0.925))
```

```{r}
cor.test(MemoryDifference$diffSeenHitOutside, MemoryDifference$PC, method = "pearson")
cor.test(MemoryDifference$diffSeenHitOutside, MemoryDifference$EC, method = "pearson")
cor.test(MemoryDifference$diffSeenHitOutside, MemoryDifference$GN, method = "pearson")
```

#### Source memory
```{r, echo = FALSE, fig.align='center', fig.width=10.8, fig.height=5.7}
PC_plot <- ggplot(data = MemoryDifference, aes(x = PC, y = diffContextAccuracyOutside)) +
  geom_point(size = 2, color = "grey70") +
  stat_smooth(method = "lm", se = FALSE, color = "red") +
  labs(x = "PC score", y = "Difference in Source Memory between Familiar and Novel rooms")

EC_plot <- ggplot(data = MemoryDifference, aes(x = EC, y = diffContextAccuracyOutside)) +
  geom_point(size = 2, color = "grey70") +
  stat_smooth(method = "lm", se = FALSE, color = "red") +
  labs(x = "EC score", y = "") +
  theme(axis.title.y = element_blank())

GN_plot <- ggplot(data = MemoryDifference, aes(x = GN, y = diffContextAccuracyOutside))  +
  geom_point(size = 2, color = "grey70") +
  stat_smooth(method = "lm", se = FALSE, color = "red") +
  labs(x = "Curiosity trait score", y = "") +
  theme(axis.title.y = element_blank())

plot_grid(PC_plot, EC_plot, GN_plot, nrow = 1, rel_widths = c(1.05, 0.925, 0.925))
```

```{r}
cor.test(MemoryDifference$diffContextAccuracyOutside, MemoryDifference$PC, method = "pearson")
cor.test(MemoryDifference$diffContextAccuracyOutside, MemoryDifference$EC, method = "pearson")
cor.test(MemoryDifference$diffContextAccuracyOutside, MemoryDifference$GN, method = "pearson")
```

## Curiosity effects
### Inside the rooms
#### Recollection
##### Using mean of PC and EC
```{r, echo = FALSE}
baseline.rating <- lme(SeenHit ~ 1, random = ~ 1|SubjectNo, data = InsideObjectsMemory_GP, method = "ML", control = list(msMaxIter = 500, opt = "optim", msVerbose=FALSE), na.action = na.exclude)

rating.intercept <- update(baseline.rating, .~. + CuriosityRating)
rating.slope     <- update(rating.intercept, random = ~ 1 + CuriosityRating|SubjectNo)

GN.intercept     <- update(rating.slope, .~. + GN)
GN.slope         <- update(GN.intercept, .~. + GN:CuriosityRating)

anova(baseline.rating, rating.intercept, rating.slope, GN.intercept, GN.slope)
```

```{r, echo=FALSE}
summary(GN.slope)
```

##### Using PC and EC separately
```{r, echo = FALSE}
baseline.rating <- lme(SeenHit ~ 1, random = ~ 1|SubjectNo, data = InsideObjectsMemory_GP, method = "ML", control = list(msMaxIter = 500, opt = "optim", msVerbose=FALSE), na.action = na.exclude)

rating.intercept <- update(baseline.rating, .~. + CuriosityRating)
rating.slope     <- update(rating.intercept, random = ~ 1 + CuriosityRating|SubjectNo)

PC.intercept     <- update(rating.slope, .~. + PC)
PC.slope         <- update(PC.intercept, .~. + PC:CuriosityRating)

EC.intercept     <- update(PC.slope,     .~. + EC)
EC.slope         <- update(EC.intercept, .~. + EC:CuriosityRating)

anova(baseline.rating, rating.intercept, rating.slope, PC.intercept, PC.slope, EC.intercept, EC.slope)
```

```{r, echo = FALSE}
summary(PC.slope)
```

Let's do this the other way around.
```{r, echo = FALSE}
EC.intercept     <- update(rating.slope,     .~. + EC)
EC.slope         <- update(EC.intercept, .~. + EC:CuriosityRating)

PC.intercept     <- update(EC.slope, .~. + PC)
PC.slope         <- update(PC.intercept, .~. + PC:CuriosityRating)

anova(baseline.rating, rating.intercept, rating.slope, EC.intercept, EC.slope, PC.intercept, PC.slope)
```

```{r, echo = FALSE}
summary(PC.slope)
```

#### Source memory
```{r, echo = FALSE}
baseline.rating <- lme(ContextAccuracy ~ 1, random = ~ 1|SubjectNo, data = InsideObjectsMemory_GP, method = "ML", control = list(msMaxIter = 500, opt = "optim", msVerbose=FALSE), na.action = na.exclude)

rating.intercept <- update(baseline.rating, .~. + CuriosityRating)
rating.slope     <- update(rating.intercept, random = ~ 1 + CuriosityRating|SubjectNo)

PC.intercept     <- update(rating.slope, .~. + PC)
PC.slope         <- update(PC.intercept, .~. + PC:CuriosityRating)

EC.intercept     <- update(PC.slope,     .~. + EC)
EC.slope         <- update(EC.intercept, .~. + EC:CuriosityRating)

anova(baseline.rating, rating.intercept, rating.slope, PC.intercept, PC.slope, EC.intercept, EC.slope)
```

```{r, echo = FALSE}
summary(EC.slope)
```

Let's do this the other way around.
```{r, echo = FALSE}
EC.intercept     <- update(rating.slope,     .~. + EC)
EC.slope         <- update(EC.intercept, .~. + EC:CuriosityRating)

PC.intercept     <- update(EC.slope, .~. + PC)
PC.slope         <- update(PC.intercept, .~. + PC:CuriosityRating)

anova(baseline.rating, rating.intercept, rating.slope, EC.intercept, EC.slope, PC.intercept, PC.slope)
```

```{r, echo = FALSE}
summary(EC.slope)
```

### Outside the rooms
#### Recollection
```{r, echo = FALSE}
baseline.rating <- lme(SeenHit ~ 1, random = ~ 1|SubjectNo, data = OutsideObjectsMemory_GP, method = "ML", control = list(msMaxIter = 500, opt = "optim", msVerbose=FALSE), na.action = na.exclude)

rating.intercept <- update(baseline.rating, .~. + CuriosityRating)
rating.slope     <- update(rating.intercept, random = ~ 1 + CuriosityRating|SubjectNo)

PC.intercept     <- update(rating.slope, .~. + PC)
PC.slope         <- update(PC.intercept, .~. + PC:CuriosityRating)

EC.intercept     <- update(PC.slope,     .~. + EC)
EC.slope         <- update(EC.intercept, .~. + EC:CuriosityRating)

anova(baseline.rating, rating.intercept, rating.slope, PC.intercept, PC.slope, EC.intercept, EC.slope)
```

```{r, echo = FALSE}
summary(EC.slope)
```

Let's do this the other way around.
```{r, echo = FALSE}
EC.intercept     <- update(rating.slope,     .~. + EC)
EC.slope         <- update(EC.intercept, .~. + EC:CuriosityRating)

PC.intercept     <- update(EC.slope, .~. + PC)
PC.slope         <- update(PC.intercept, .~. + PC:CuriosityRating)

anova(baseline.rating, rating.intercept, rating.slope, EC.intercept, EC.slope, PC.intercept, PC.slope)
```

```{r, echo = FALSE}
summary(PC.slope)
```

#### Source memory
```{r, echo = FALSE}
baseline.rating <- lme(ContextAccuracy ~ 1, random = ~ 1|SubjectNo, data = OutsideObjectsMemory_GP, method = "ML", control = list(msMaxIter = 500, opt = "optim", msVerbose=FALSE), na.action = na.exclude)

rating.intercept <- update(baseline.rating, .~. + CuriosityRating)
rating.slope     <- update(rating.intercept, random = ~ 1 + CuriosityRating|SubjectNo)

PC.intercept     <- update(rating.slope, .~. + PC)
PC.slope         <- update(PC.intercept, .~. + PC:CuriosityRating)

EC.intercept     <- update(PC.slope,     .~. + EC)
EC.slope         <- update(EC.intercept, .~. + EC:CuriosityRating)

anova(baseline.rating, rating.intercept, rating.slope, PC.intercept, PC.slope, EC.intercept, EC.slope)
```

Let's do this the other way around.
```{r, echo = FALSE}
EC.intercept     <- update(rating.slope,     .~. + EC)
EC.slope         <- update(EC.intercept, .~. + EC:CuriosityRating)

PC.intercept     <- update(EC.slope, .~. + PC)
PC.slope         <- update(PC.intercept, .~. + PC:CuriosityRating)

anova(baseline.rating, rating.intercept, rating.slope, EC.intercept, EC.slope, PC.intercept, PC.slope)
```








