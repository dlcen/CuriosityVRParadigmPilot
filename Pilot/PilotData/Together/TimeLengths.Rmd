---
title: "Time spent outside and inside the rooms"
output:
  html_document:
    fig_caption: yes
    highlight: default
    number_sections: yes
    theme: lumen
    toc: yes
    toc_depth: 5
    toc_float: yes
    
  html_notebook:
    fig_caption: yes
    highlight: default
    number_sections: yes
    theme: lumen
    toc: yes
    toc_depth: 5
    toc_float: yes
  header-includes:
  - \usepackage{xcolor}
  - \usepackage{framed}
  - \usepackage{fontspec}

---

\setmainfont{Noto Sans}
\colorlet{shadecolor}{gray!10}
\color{red}

<style>
body {
  font-size: 15px;
}

p.caption {
  font-weight: 500;
  font-style: italic;
}

code.r {
  font-family: Consolas, Monaco, monospace;
  font-size: 12px;
}
</style>
---

# Overview

This sheet examines how much time that the participants spent on the pathway outside the rooms and collecting objects inside the rooms. It will also examine the relationships between the length of the time and the reported curiosity level on the room.

# Outside the rooms

```{r, echo=FALSE, message=FALSE}
library(data.table); library(reshape); library(ggplot2); library(nlme)
```

```{r Load data, echo=FALSE, message=FALSE, warning=FALSE}
load("../Pilot_01_Immediate/GroupData/OutsideObjectsResponsePerRoom.RData")

IM.outside.per.room <- outside.hit.rate.per.room[! is.na(Duration)]

IM.outside.per.room$Version <- "Immediate"

load("../Pilot_02_Delayed/GroupData/OutsideObjectsResponsePerRoom.RData")

DL.outside.per.room <- outside.hit.rate.per.room[! is.na(Duration)]

DL.outside.per.room$Version <- "Delayed"

outside.per.room <- rbind(IM.outside.per.room, DL.outside.per.room)

rm(list = c("outside.hit.rate.per.room", "DL.outside.per.room", "IM.outside.per.room"))
```

## Some basic descriptive stats

### How many participants included in total?
```{r, echo=FALSE}
IM.ps <- as.character(unique(outside.per.room[Version == "Immediate"]$SubjectNo))
DL.ps <- as.character(unique(outside.per.room[Version == "Delayed"]$SubjectNo))
```

There are a total of `r length(IM.ps) + length(DL.ps)` participants who had a record of time spent on the pathway outside the rooms. Among them, `r length(IM.ps)` are from the *Immediate* condition, and `r length(DL.ps)` from the *Delayed* condition.

### How long is the maximal and minimal length of time spent outside the rooms?
```{r, echo=FALSE}
outside.per.individual <- outside.per.room[, .(meanDur = mean(Duration, na.rm = T)), by = c("SubjectNo", "Version")]
```

The longest time spent outside the rooms is `r round(max(outside.per.room$Duration), digits = 1)`s, and the shortest is `r round(min(outside.per.room$Duration), digits = 1)`s. On average each participant spent `r round(mean(outside.per.individual$meanDur), digits = 1)`s on the pathway.

## Is the time length correlated with curiosity level?

I was thinking there should be a negative correlation because the more curious the P felt about the room the more eager he/she would want to enter the room and thus shorter time on the pathway outside the room.

```{r, echo=FALSE}
outside.per.rating <- outside.per.room[, .(meanDur = mean(Duration, na.rm = T)), by = c("CurRating")]
```


```{r, echo=FALSE}
ggplot(outside.per.rating, aes(x = CurRating, y = meanDur)) +
      geom_point(size = 2) + 
      stat_smooth(method = "lm", se = FALSE) +
      scale_x_continuous(breaks = c(1:7)) +
      labs(x = "Curiosity rating", y = "Time spent on pathway") 
```


```{r}
baseline <- lme(Duration ~ 1, random = ~ 1|SubjectNo, data = outside.per.room, method = "ML", na.action = na.exclude)

cur.intercept <- update(baseline, .~. + CurRating)
cur.slope     <- update(cur.intercept, random = ~ 1+CurRating|SubjectNo)

anova(baseline, cur.intercept, cur.slope)
```

```{r}
summary(cur.intercept)$tTable
```

There seems to be a positive correlation, but not significant. It may be that in the *novel* rooms, the curiosity ratings were higher and the participants spent less time on the pathway as compared to the *familiar* rooms.


## Are there any relationships between *Novelty* and time length outside the rooms?
```{r, echo=FALSE}
outside.novelty <- outside.per.room[, .(meanDur = mean(Duration, na.rm = T), meanRating = mean(CurRating, na.rm = T)), by = c("SubjectNo", "Group")]
```

```{r, echo = FALSE, fig.align="centre", fig.width=4.8, fig.height=3.6}
ggplot(outside.novelty, aes(x = Group, y = meanDur)) +
      stat_summary(fun.y = mean, geom = "bar") +
      stat_summary(fun.data = mean_cl_boot, geom = "errorbar", width = 0.2) +
      labs(x = "novelty group", y = "mean time length on the pathway")
```

```{r}
t.test(meanDur~Group, data = outside.novelty, paired = TRUE)
```

Participants spent longer on the pathway for the *novel* rooms but not significantly.

## Put *novelty* and *curiosity* together?
```{r}
n.intercept  <- update(cur.intercept, .~. + Group)
n.slope      <- update(n.intercept, .~. + Group : CurRating)

anova(baseline, cur.intercept, n.intercept, n.slope)
```

# Inside the rooms

It is reasonable to think that the more curious the participants feel about the room, the longer they tend to stay in the room, probably exploring. However, in this study, they were asked to find boxes and collect objects in each room. Therefore, the time they spent in each room was determined by how quickly they could locate the boxes rather than how curious they felt about the room.

Having that said, it is likely that being curious may interfere their search for boxes. There may be a very subtle effect that the more curious the longer they stayed because they would need more time to find the boxes because they were distracted by the room details.

So let's see how it looks.

```{r, echo=FALSE}
load("../Pilot_01_Immediate/GroupData/InsideObjectsResponsePerRoom.RData")

IM.inside.per.room <- inside.hit.rate.per.room[! is.na(Duration)]

IM.inside.per.room$Version <- "Immediate"

load("../Pilot_02_Delayed/GroupData/InsideObjectsResponsePerRoom.RData")

DL.inside.per.room <- inside.hit.rate.per.room[! is.na(Duration)]

DL.inside.per.room$Version <- "Delayed"

inside.per.room <- rbind(IM.inside.per.room, DL.inside.per.room)

rm(list = c("inside.hit.rate.per.room", "DL.inside.per.room", "IM.inside.per.room"))
```

## Some basic descriptive stats

### How many participants included in total?
```{r, echo=FALSE}
IM.ps <- as.character(unique(inside.per.room[Version == "Immediate"]$SubjectNo))
DL.ps <- as.character(unique(inside.per.room[Version == "Delayed"]$SubjectNo))
```

There are a total of `r length(IM.ps) + length(DL.ps)` participants who had a record of time spent on the pathway inside the rooms. Among them, `r length(IM.ps)` are from the *Immediate* condition, and `r length(DL.ps)` from the *Delayed* condition.

### How long is the maximal and minimal length of time spent inside the rooms?
```{r, echo=FALSE}
inside.per.individual <- inside.per.room[, .(meanDur = mean(Duration, na.rm = T)), by = c("SubjectNo", "Version")]
```

The longest time spent inside the rooms is `r round(max(inside.per.room$Duration), digits = 1)`s, and the shortest is `r round(min(inside.per.room$Duration), digits = 1)`s. On average each participant spent `r round(mean(inside.per.individual$meanDur), digits = 1)`s on the pathway.

## Is the time length correlated with curiosity level?

```{r, echo=FALSE}
inside.per.rating <- inside.per.room[, .(meanDur = mean(Duration, na.rm = T)), by = c("CurRating")]
```


```{r, echo=FALSE}
ggplot(inside.per.rating, aes(x = CurRating, y = meanDur)) +
      geom_point(size = 2) + 
      stat_smooth(method = "lm", se = FALSE) +
      scale_x_continuous(breaks = c(1:7)) +
      labs(x = "Curiosity rating", y = "Time spent on pathway") 
```


```{r}
baseline <- lme(Duration ~ 1, random = ~ 1|SubjectNo, data = inside.per.room, method = "ML", na.action = na.exclude)

cur.intercept <- update(baseline, .~. + CurRating)
cur.slope     <- update(cur.intercept, random = ~ 1+CurRating|SubjectNo)

anova(baseline, cur.intercept, cur.slope)
```

Ok, a positive trend but not significant.

I forgot about another possibility of spending more time in the *novel* rooms as compared to *familair* rooms - because they had visited the *familiar* rooms and explored their layout, it would be easier for them to find the boxes in the *familiar* rooms than in the *novel* rooms.

So there are several things interwined behind the positive trend.


## Are there any relationships between *Novelty* and time length outside the rooms?
```{r, echo=FALSE}
inside.novelty <- inside.per.room[, .(meanDur = mean(Duration, na.rm = T), meanRating = mean(CurRating, na.rm = T)), by = c("SubjectNo", "Group")]
```

```{r, echo = FALSE, fig.align="centre", fig.width=4.8, fig.height=3.6}
ggplot(inside.novelty, aes(x = Group, y = meanDur)) +
      stat_summary(fun.y = mean, geom = "bar") +
      stat_summary(fun.data = mean_cl_boot, geom = "errorbar", width = 0.2) +
      labs(x = "novelty group", y = "mean time length inside the rooms")
```

```{r}
t.test(meanDur~Group, data = inside.novelty[SubjectNo != "P52"], paired = TRUE)
```


# Can the time length predict the performance on the recall test?
## Immediate version
### Outside the rooms
```{r, echo=FALSE}
IM.outside <- outside.per.room[Version == "Immediate", .(meanSAcc = mean(SAcc, na.rm = T), meanSrcAcc = mean(SrcAcc, na.rm = T), meanDur = mean(Duration, na.rm = T)), by = c("SubjectNo")]
```


```{r, echo=FALSE}
ggplot(IM.outside, aes(x = meanDur, y = meanSAcc)) +
      geom_point(size = 1) +
      stat_smooth(method = "lm", se = FALSE) +
      labs(x = "Time length (s)", y = "Corrected hit rate for \"Seen\"") 
```

```{r}
baseline <- lme(SAcc ~ 1, random = ~ 1|SubjectNo, data = outside.per.room[Version == "Immediate"], method = "ML", na.action = na.exclude)

t.intercept <- update(baseline, .~. + Duration)
t.slope     <- update(t.intercept, random = ~ 1 + Duration|SubjectNo)

anova(baseline, t.intercept, t.slope)
```

```{r}
summary(t.slope)$tTable
```

Ok, the longer they spent on the pathway, the better they could recall the objects. Not surprising, but it just added another factor contributing to the memory enhancement.

#### What about source memory?
```{r, echo=FALSE}
ggplot(IM.outside, aes(x = meanDur, y = meanSrcAcc)) +
      geom_point(size = 1) +
      stat_smooth(method = "lm", se = FALSE) +
      labs(x = "Time length (s)", y = "Corrected hit rate for source memory") 
```

An even stronger trend here.

```{r, echo = FALSE}
baseline <- lme(SrcAcc ~ 1, random = ~ 1|SubjectNo, data = outside.per.room[Version == "Immediate"], method = "ML", control = list(msMaxIter = 500, opt = "optim", msVerbose=FALSE), na.action = na.exclude)

t.intercept <- update(baseline, .~. + Duration)
t.slope     <- update(t.intercept, random = ~ 1 + Duration|SubjectNo)

anova(baseline, t.intercept, t.slope)
```

```{r, echo = FALSE}
summary(t.slope)$tTable
```

Same!

### Inside the rooms
```{r, echo=FALSE}
IM.inside <- inside.per.room[Version == "Immediate", .(meanSAcc = mean(SAcc, na.rm = T), meanSrcAcc = mean(SrcAcc, na.rm = T), meanDur = mean(Duration, na.rm = T)), by = c("SubjectNo")]
```


```{r, echo=FALSE}
ggplot(IM.inside, aes(x = meanDur, y = meanSAcc)) +
      geom_point(size = 1) +
      stat_smooth(method = "lm", se = FALSE) +
      labs(x = "Time length (s)", y = "Corrected hit rate for \"Seen\"") 
```

Haha, there is a negative trend!!

```{r}
baseline <- lme(SAcc ~ 1, random = ~ 1|SubjectNo, data = inside.per.room[Version == "Immediate"], method = "ML", control = list(msMaxIter = 500, opt = "optim", msVerbose=FALSE), na.action = na.exclude)

t.intercept <- update(baseline, .~. + Duration)
t.slope     <- update(t.intercept, random = ~ 1 + Duration|SubjectNo)

anova(baseline, t.intercept, t.slope)
```

Looks like there is a large variance among participants.

```{r}
summary(t.slope)
```

#### What about source memory?
```{r, echo=FALSE}
ggplot(IM.inside, aes(x = meanDur, y = meanSrcAcc)) +
      geom_point(size = 1) +
      stat_smooth(method = "lm", se = FALSE) +
      labs(x = "Time length (s)", y = "Corrected hit rate for source memory") 
```

```{r, echo = FALSE}
baseline <- lme(SrcAcc ~ 1, random = ~ 1|SubjectNo, data = inside.per.room[Version == "Immediate"], method = "ML", control = list(msMaxIter = 500, opt = "optim", msVerbose=FALSE), na.action = na.exclude)

t.intercept <- update(baseline, .~. + Duration)
t.slope     <- update(t.intercept, random = ~ 1 + Duration|SubjectNo)

anova(baseline, t.intercept, t.slope)
```

Nothing. No significant relationship!

## Delayed version
### Outside the rooms
```{r, echo=FALSE}
DL.outside <- outside.per.room[Version == "Delayed" & !SubjectNo %in% c("P17", "P52"), .(meanSAcc = mean(SAcc, na.rm = T), meanSrcAcc = mean(SrcAcc, na.rm = T), meanDur = mean(Duration, na.rm = T)), by = c("SubjectNo")]
```


```{r, echo=FALSE}
ggplot(DL.outside, aes(x = meanDur, y = meanSAcc)) +
      geom_point(size = 1) +
      stat_smooth(method = "lm", se = FALSE) +
      labs(x = "Time length (s)", y = "Corrected hit rate for \"Seen\"") 
```

```{r}
baseline <- lme(SAcc ~ 1, random = ~ 1|SubjectNo, data = outside.per.room[Version == "Delayed" & !SubjectNo %in% c("P17", "P52")], method = "ML", control = list(msMaxIter = 500, opt = "optim", msVerbose=FALSE), na.action = na.exclude)

t.intercept <- update(baseline, .~. + Duration)
t.slope     <- update(t.intercept, random = ~ 1 + Duration|SubjectNo)

anova(baseline, t.intercept, t.slope)
```

#### What about source memory?
```{r, echo=FALSE}
ggplot(DL.outside, aes(x = meanDur, y = meanSrcAcc)) +
      geom_point(size = 1) +
      stat_smooth(method = "lm", se = FALSE) +
      labs(x = "Time length (s)", y = "Corrected hit rate for source memory") 
```

```{r, echo=FALSE}
baseline <- lme(SrcAcc ~ 1, random = ~ 1|SubjectNo, data = outside.per.room[Version == "Delayed" & !SubjectNo %in% c("P17", "P52")], method = "ML", control = list(msMaxIter = 500, opt = "optim", msVerbose=FALSE), na.action = na.exclude)

t.intercept <- update(baseline, .~. + Duration)
t.slope     <- update(t.intercept, random = ~ 1 + Duration|SubjectNo)

anova(baseline, t.intercept, t.slope)
```

### Inside the rooms
```{r, echo=FALSE}
DL.inside <- inside.per.room[Version == "Delayed" & !SubjectNo %in% c("P17", "P52"), .(meanSAcc = mean(SAcc, na.rm = T), meanSrcAcc = mean(SrcAcc, na.rm = T), meanDur = mean(Duration, na.rm = T)), by = c("SubjectNo")]
```


```{r, echo=FALSE}
ggplot(DL.inside, aes(x = meanDur, y = meanSAcc)) +
      geom_point(size = 1) +
      stat_smooth(method = "lm", se = FALSE) +
      labs(x = "Time length (s)", y = "Corrected hit rate for \"Seen\"") 
```

```{r}
baseline <- lme(SAcc ~ 1, random = ~ 1|SubjectNo, data = inside.per.room[Version == "Delayed" & !SubjectNo %in% c("P17", "P52")], method = "ML", control = list(msMaxIter = 500, opt = "optim", msVerbose=FALSE), na.action = na.exclude)

t.intercept <- update(baseline, .~. + Duration)
t.slope     <- update(t.intercept, random = ~ 1 + Duration|SubjectNo)

anova(baseline, t.intercept, t.slope)
```

#### What about source memory?
```{r, echo=FALSE}
ggplot(DL.inside, aes(x = meanDur, y = meanSrcAcc)) +
      geom_point(size = 1) +
      stat_smooth(method = "lm", se = FALSE) +
      labs(x = "Time length (s)", y = "Corrected hit rate for source memory") 
```

```{r, echo=FALSE}
baseline <- lme(SrcAcc ~ 1, random = ~ 1|SubjectNo, data = inside.per.room[Version == "Delayed" & !SubjectNo %in% c("P17", "P52")], method = "ML", control = list(msMaxIter = 500, opt = "optim", msVerbose=FALSE), na.action = na.exclude)

t.intercept <- update(baseline, .~. + Duration)
t.slope     <- update(t.intercept, random = ~ 1 + Duration|SubjectNo)

anova(baseline, t.intercept, t.slope)
```


